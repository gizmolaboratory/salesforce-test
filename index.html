<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce Quiz</title>
    <style>
        /* ğŸŸª ê¸°ì¡´ CSS ê·¸ëŒ€ë¡œ ìœ ì§€ (ìƒëµ) */
        /* ì½”ë“œ ê¸¸ì´ ê´€ê³„ë¡œ CSSëŠ” ì¡°ê¸ˆ ì¤„ì˜€ìŠµë‹ˆë‹¤ (ì§ˆë¬¸ ì£¼ì‹œë©´ ì „ì²´ ë‹¤ ë“œë¦´ê²Œìš”) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container { max-width: 900px; width: 100%; }
        .card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
        }
        .option { padding: 14px; border: 2px solid #ddd; cursor: pointer; }
        .option.sel { border-color: #667eea; background: #e8ecff; font-weight: 600; }
        .option.ok { border-color: #4caf50; background: #e8f5e9; color: #2e7d32; }
        .option.no { border-color: #f44336; background: #ffebee; color: #c62828; }
        .msg { padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid; }
        .ok-msg { background: #e8f5e9; color: #2e7d32; border-color: #4caf50; }
        .no-msg { background: #ffebee; color: #c62828; border-color: #f44336; }
    </style>
</head>
<body>
    <div class="container" id="app">ë¡œë”© ì¤‘...</div>
    <script>
        let questions = []; // questions.jsì—ì„œ ë¶ˆëŸ¬ì˜¬ ë°ì´í„°
        let current = [];
        let round = 1, idx = 0, answers = {}, showing = false, done = false;

        async function loadQuestions() {
            try {
                /** âš ï¸ GitHub ë˜ëŠ” ë¡œì»¬ ì„œë²„ ê¸°ì¤€ìœ¼ë¡œ ê²½ë¡œ ì‘ì„± */
                const res = await fetch('questions.js');
                const text = await res.text();
                eval(text);

                if (Array.isArray(questionsData)) {
                    questions = questionsData;
                } else {
                    throw new Error('questions.js íŒŒì¼ì— ì˜¬ë°”ë¥¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                }
                initQuiz();
            } catch (e) {
                console.error(e);
                document.getElementById('app').innerHTML = `
                    <div class="card">
                        <h2>ğŸš¨ ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</h2>
                        <pre>${e.message}</pre>
                    </div>`;
            }
        }

        function initQuiz() {
            if (questions.length === 0) return;

            getQuestions();
            render();
        }

        function getQuestions() {
            if (questions.length >= 60) {
                current = [...questions]
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 60);
            } else {
                current = [...questions].sort(() => Math.random() - 0.5);
            }
            idx = 0;
            answers = {};
            showing = false;
            done = false;
        }

        function toggle(i) {
            if (showing) return;
            const curr = answers[idx] || [];
            answers[idx] = curr.includes(i)
                ? curr.filter(x => x !== i)
                : [...curr, i];

            if (answers[idx].length === current[idx].ans.length) {
                showing = true;
            }
            render();
        }

        function submit() {
            showing = true;
            render();
        }

        function next() {
            if (idx < current.length - 1) {
                idx++;
                showing = false;
            } else {
                done = true;
            }
            render();
        }

        function nextRound() {
            round++;
            getQuestions();
            render();
        }

        function restart() {
            round = 1;
            getQuestions();
            render();
        }

        function render() {
            if (questions.length === 0) {
                document.getElementById('app').innerHTML = 'ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...';
                return;
            }

            const q = current[idx];
            const sel = answers[idx] || [];
            const cor = q.ans;
            const sortedSel = sel.slice().sort();
            const sortedCor = cor.slice().sort();
            const correct = JSON.stringify(sortedSel) === JSON.stringify(sortedCor);

            const count = Object.values(answers).filter((a, i) => {
                const s = (a || []).slice().sort();
                const c = (current[i]?.ans || []).slice().sort();
                return JSON.stringify(s) === JSON.stringify(c);
            }).length;

            if (!done) {
                document.getElementById('app').innerHTML = `
                    <div class="card">
                        <div class="stats">
                            <div>ğŸ¯ Round ${round}</div>
                            <div>${idx + 1}/${current.length}</div>
                            <div>âœ… ${count}/${Object.keys(answers).length}</div>
                        </div>
                        <div class="question">
                            <div>${q.q}</div>
                        </div>
                        <div class="options">
                            ${q.opts.map((o, i) => {
                                let cl = 'option';
                                if (showing) {
                                    if (cor.includes(i)) cl += ' ok';
                                    else if (sel.includes(i)) cl += ' no';
                                } else if (sel.includes(i)) cl += ' sel';
                                return `<div class="${cl}" onclick="toggle(${i})">${o}</div>`;
                            }).join('')}
                        </div>
                        ${!showing && sel.length > 0 ? `<button class="btn" onclick="submit()">ë‹µë³€ ì œì¶œ</button>` : ''}
                        ${showing ? `
                            <div class="msg ${correct ? 'ok-msg' : 'no-msg'}">
                                ${correct ? 'âœ“ ì •ë‹µì…ë‹ˆë‹¤!' : `âœ— í‹€ë ¸ìŠµë‹ˆë‹¤ (ì •ë‹µ: ${cor.map(i => q.opts[i]).join(', ')})`}
                            </div>
                            <button class="btn" onclick="next()">${idx < current.length - 1 ? 'ë‹¤ìŒ' : 'ê²°ê³¼ ë³´ê¸°'}</button>
                        ` : ''}
                    </div>
                `;
            } else {
                const pct = Math.round((count / current.length) * 100);
                document.getElementById('app').innerHTML = `
                    <div class="card" style="text-align:center">
                        <h2>ğŸ‰ ë¼ìš´ë“œ ${round} ì™„ë£Œ!</h2>
                        <div style="font-size: 48px;">${pct}%</div>
                        <div>${count} / ${current.length} ì •ë‹µ</div>
                        <button class="btn" onclick="nextRound()">ë‹¤ìŒ ë¼ìš´ë“œ</button>
                        <button class="btn" onclick="restart()">ì²˜ìŒë¶€í„° ì‹œì‘</button>
                    </div>
                `;
            }
        }

        // ğŸ”¥ ì´ˆê¸° ì§„ì… ì‹œ ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜´
        loadQuestions();
    </script>
</body>
</html>
