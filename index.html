<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce Quiz</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container { max-width: 900px; width: 100%; }
        .card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.6s ease-out;
        }
        h2 { font-size: 24px; color: #333; margin-bottom: 20px; }
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            transition: all 0.3s;
            margin-top: 20px;
        }
        .btn:hover { transform: translateY(-3px); }
        .stats {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .stat {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); transition: width 0.3s; }
        .question { margin-bottom: 20px; }
        .q-text { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 15px; line-height: 1.5; }
        .options { display: grid; gap: 10px; margin-bottom: 20px; }
        .option {
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            background: white;
            text-align: left;
            transition: all 0.2s;
            font-size: 14px;
        }
        .option:hover { border-color: #667eea; background: #f8f9ff; }
        .option.sel { border-color: #667eea; background: #e8ecff; font-weight: 600; }
        .option.ok { border-color: #4caf50; background: #e8f5e9; color: #2e7d32; }
        .option.no { border-color: #f44336; background: #ffebee; color: #c62828; }
        .msg {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 600;
            border-left: 4px solid;
        }
        .ok-msg { background: #e8f5e9; color: #2e7d32; border-color: #4caf50; }
        .no-msg { background: #ffebee; color: #c62828; border-color: #f44336; }
        .score { font-size: 48px; font-weight: 900; color: #667eea; margin: 20px 0; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="container" id="app">ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>

    <script>
        let questions = []; // questions.jsì—ì„œ ë¡œë“œë˜ëŠ” ì „ì—­ ë³€ìˆ˜
        let current = [];
        let round = 1, idx = 0, answers = {}, showing = false, done = false;

        async function loadQuestions() {
            try {
                const res = await fetch('https://raw.githubusercontent.com/gizmolaboratory/salesforce-test/refs/heads/main/questions.js');
                const text = await res.text();
                eval(text); // const questions = [...] ë¡œ ì„ ì–¸ëœ ë°ì´í„° ì‹¤í–‰

                if (!Array.isArray(questions)) {
                    throw new Error('questions.jsì—ì„œ questions ë°°ì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }

                console.log(`âœ… ì´ ${questions.length}ê°œì˜ ë¬¸ì œê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                initQuiz();
            } catch (e) {
                document.getElementById('app').innerHTML = `
                    <div class="card">
                        <h2>ğŸš¨ ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</h2>
                        <pre>${e.message}</pre>
                    </div>`;
            }
        }

        function initQuiz() {
            getQuestions();
            render();
        }

        function getQuestions() {
            current = [...questions].sort(() => Math.random() - 0.5).slice(0, 60);
            idx = 0;
            answers = {};
            showing = false;
            done = false;
        }

        function toggle(i) {
            if (showing) return;
            const curr = answers[idx] || [];
            answers[idx] = curr.includes(i) ? curr.filter(x => x !== i) : [...curr, i];

            if (answers[idx].length === current[idx].ans.length) {
                showing = true;
            }
            render();
        }

        function submit() {
            showing = true;
            render();
        }

        function next() {
            if (idx < current.length - 1) {
                idx++;
                showing = false;
            } else {
                done = true;
            }
            render();
        }

        function nextRound() {
            round++;
            getQuestions();
            render();
        }

        function restart() {
            round = 1;
            getQuestions();
            render();
        }

        function render() {
            const app = document.getElementById('app');
            if (questions.length === 0) return;

            const q = current[idx];
            const sel = answers[idx] || [];
            const cor = q.ans;

            const correct = JSON.stringify(sel.slice().sort()) === JSON.stringify(cor.slice().sort());

            const count = Object.values(answers).filter((a, i) => 
                JSON.stringify((a || []).slice().sort()) === JSON.stringify((current[i]?.ans || []).slice().sort())
            ).length;

            if (!done) {
                app.innerHTML = `
                    <div class="card">
                        <div class="stats">
                            <div class="stat">ğŸ¯ Round ${round}</div>
                            <div class="stat">ğŸ“Š Q${idx + 1}/60</div>
                            <div class="stat">âœ… ${count}/${Object.keys(answers).length}</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress" style="width: ${((idx + 1) / 60) * 100}%"></div>
                        </div>
                        <div class="question">
                            <div class="q-text">${q.q}</div>
                        </div>
                        <div class="options">
                            ${q.opts.map((o, i) => {
                                let cl = 'option';
                                if (showing) {
                                    if (cor.includes(i)) cl += ' ok';
                                    else if (sel.includes(i)) cl += ' no';
                                } else if (sel.includes(i)) cl += ' sel';
                                return `<div class="${cl}" onclick="toggle(${i})">${o}</div>`;
                            }).join('')}
                        </div>
                        ${!showing && sel.length > 0 ? `<button class="btn" onclick="submit()">ë‹µë³€ ì œì¶œ</button>` : ''}
                        ${showing ? `
                            <div class="msg ${correct ? 'ok-msg' : 'no-msg'}">
                                ${correct ? 'âœ“ ì •ë‹µì…ë‹ˆë‹¤!' : `âœ— ì˜¤ë‹µì…ë‹ˆë‹¤ (ì •ë‹µ: ${cor.map(i => q.opts[i]).join(', ')})`}
                            </div>
                            <button class="btn" onclick="next()">${idx < 59 ? 'ë‹¤ìŒ' : 'ê²°ê³¼ ë³´ê¸°'}</button>
                        ` : ''}
                    </div>
                `;
            } else {
                const pct = Math.round((count / 60) * 100);
                app.innerHTML = `
                    <div class="card" style="text-align: center;">
                        <h2>ğŸ‰ ë¼ìš´ë“œ ${round} ì™„ë£Œ!</h2>
                        <div class="score">${pct}%</div>
                        <div style="font-size: 16px; color: #666; margin-bottom: 30px;">${count} / 60 ì •ë‹µ</div>
                        <button class="btn" onclick="nextRound()" style="margin-bottom: 10px;">ë‹¤ìŒ ë¼ìš´ë“œ</button>
                        <button class="btn" onclick="restart()">ì²˜ìŒë¶€í„°</button>
                    </div>
                `;
            }
        }

        loadQuestions();
    </script>
</body>
</html>
